
Cada vez que se ejecuta una **Function**, se le pasan 3 parámetros:

1. **context**: Objeto que incluye información sobre el entorno de ejecución, como las variables de entorno.  
2. **event**: Objeto que incluye información sobre una invocación específica de la Function, como los parámetros HTTP que se pasaron con la solicitud que activó la Function.  
3. **callback**: Función de JavaScript que debes llamar para retornar desde tu Function.

La siguiente animación explica estos parámetros en un ejemplo de Function.

![[Pasted image 20250204173302.png]]

![[Pasted image 20250204173336.png]]

---

La función **callback** es importante, así que hablemos de algunos detalles. Toma dos parámetros: **error** y **response**.

- Si el parámetro **error** está presente, la Function devolverá una respuesta HTTP **500** con el valor del error como carga útil.  
- Si el parámetro **response** está presente, la Function devolverá una respuesta HTTP **200** con el valor de la respuesta como carga útil.

Al devolver una respuesta, la Function establece automáticamente el encabezado HTTP **Content-Type** según el tipo de respuesta que proporciones:

- Para respuestas **TwiML**, el tipo de contenido será **text/xml**.  
- Para objetos de JavaScript, el tipo de contenido será **application/json** (y la respuesta se convertirá automáticamente a JSON).  
- Para cadenas de texto, el tipo de contenido será **text/plain**.

**El tiempo de ejecución de una Function está limitado a 10 segundos**

Por último, pero no menos importante, el tiempo de ejecución de una Function está limitado a **10 segundos**. Esto significa que, una vez ejecutada, la Function se ejecutará durante un máximo de 10 segundos o hasta que se llame a la función **callback**, lo que ocurra primero.

---
La siguiente **Function** siempre agota el tiempo de espera cuando se ejecuta.  
¿Puedes pensar por qué podría ser?

![[Pasted image 20250204180820.png]]

Debido a que return no es una forma válida de regresar desde una función, es necesario llamar al método de devolución de llamada, es decir:

![[Pasted image 20250204181600.png]]

---
La siguiente función se supone que envía un SMS.

Siempre se completa correctamente y devuelve "enviado", pero nunca envía el mensaje. ¿Por qué?

![[Pasted image 20250204181648.png]]

La ejecución de la función se terminará cuando se llame al método `callback()`. Eso incluye cualquier proceso asíncrono que aún pueda estar ejecutándose.

Y dado que `message.create()` es una operación asíncrona que devuelve una Promesa, la posterior llamada a `callback()` la termina antes de que tenga tiempo de ejecutarse.

Si queremos que `message.create()` se ejecute, necesitamos esperar a que la Promesa se resuelva y solo invocar `callback()` desde el método `then()` correspondiente.

![[Pasted image 20250204182146.png]]

