En este ejercicio, construiremos un componente **React** personalizado que mostrará una cita aleatoria y se estilizará utilizando el tema de **Flex**.

El resultado final debería verse algo así:

![[Pasted image 20250209233559.png]]

Antes de empezar a construir el componente en sí, discutamos dónde debería colocarse el componente. El **NoTasksCanvas**, que se muestra al agente cuando no hay tareas, parece un buen lugar.

Así es como se ve por defecto:

![[Pasted image 20250209233610.png]]

No necesitaremos las siguientes 3 líneas: "Estado", "Sin tareas activas" y "Estás listo para empezar a recibir tareas". Vamos a eliminarlas primero.

Para eliminar componentes existentes de **Flex UI**, necesitas dos piezas de información:

- El componente principal
- La clave del componente a eliminar

Una forma fácil de obtener ambas es usando algo como la extensión de navegador [**React Developer Tools**](https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=en). Con ella instalada, haz clic derecho sobre la parte de la interfaz de usuario que te interesa y selecciona "Inspeccionar". Luego, selecciona la pestaña **Componentes** y encuentra tu componente en el árbol de componentes de **React**.

![[Pasted image 20250209233650.png]]

En nuestro caso, el componente principal de los tres componentes que queremos eliminar es **NoTaskCanvas** y las claves son **first-line**, **second-line** y **hint**. ¡Vamos a eliminarlos!

```js
async init(flex, manager) {
  // set logo
  flex.MainHeader.defaultProps.logoUrl =
    'https://tangerine-toad-5117.twil.io/assets/feathercorp-logo-white.svg';

  // set color theme
  manager.updateConfig({ colorTheme: FeatherTheme });

  // remove default components
  flex.NoTasksCanvas.Content.remove('first-line');
  flex.NoTasksCanvas.Content.remove('second-line');
  flex.NoTasksCanvas.Content.remove('hint');
}
```

Así es como debería verse ahora tu **NoTasksCanvas**:

![[Pasted image 20250209233703.png]]

### withTheme()

La última pieza que falta es cómo nuestro componente accederá al tema de **Flex**, para que pueda renderizarse con él. Para estilizar los componentes, **Flex UI** proporciona el [Higher-Order Component (HOC) **withTheme()**](https://reactjs.org/docs/higher-order-components.html). Un HOC es una función que toma un componente como entrada y devuelve una nueva versión (generalmente mejorada de alguna manera) del componente como salida.

En nuestro caso, **withTheme()** tomará nuestro componente personalizado y devolverá una versión de él que podrá acceder al tema actual de **Flex** a través de una prop de **theme**.

Ahora que hemos cubierto eso, construyamos nuestro componente personalizado. Comenzaremos construyendo el componente en sí y cubriremos el estilo al final.

Usaremos la [**Quotable API**](https://github.com/lukePeavey/quotable) para recuperar las citas aleatorias.

Primero, ve a la carpeta **src/components** de tu plugin y crea una nueva subcarpeta llamada **Quote**. Construiremos nuestro componente personalizado aquí.

Este es el código del componente [(Quote.jsx)](https://rise-flexlabs-5526-dev.twil.io/code_snippets/Quote.jsx), los comentarios están a continuación:

```js
/* archivo: src/components/Quote/Quote.jsx */

import React, { Component } from 'react';
import { withTheme } from '@twilio/flex-ui';

// importación de componentes estilizados simples
import {
  QuoteComponentStyled, HeaderLine, Header, QuoteBody, QuoteAuthor
} from './Quote.Styles';

// URL de la API de quotable para obtener citas
const url = `https://api.quotable.io/random?tags=life`;

// el componente principal
class QuoteComponent extends Component {
  
  // inicializar variables de estado
  constructor(props) {
    super(props);
    this.state = {
      quote: null,    // cuerpo de la cita
      author: null,   // autor de la cita
      loaded: false,  // ¿se ha completado la carga?
      error: null     // ¿ocurrió un error?
    };
  }

  componentDidMount() {
    // una vez que el componente se monte, recuperamos la cita aleatoria de la API...
    fetch(url)
      .then((response) => response.json())
      .then((json) => {
        // ...y la almacenamos en el estado del componente
        this.setState({
          quote: json.content,
          author: json.author,
          loaded: true
        });
      })
      // si ocurrió un error, guardamos su descripción
      .catch((error) => this.setState({ error, loaded: true }));
  }

  render() {
    // extraemos variables del estado
    const { quote, author, error, loaded } = this.state;
    let value = quote;

    // mostramos el mensaje de error o de carga si es necesario
    if (error) {
      console.error(error);
      value = `Error: ${error}`;
    }
    if (!loaded) {
      value = 'Cargando...';
    }

    // y finalmente renderizamos la cita utilizando los componentes estilizados
    return (
      <QuoteComponentStyled>
        <HeaderLine>
          <Header>Cita del Día</Header>
        </HeaderLine>
        <QuoteBody>{value}</QuoteBody>
        <QuoteAuthor>{author ? author : ''}</QuoteAuthor>
      </QuoteComponentStyled>
    );
  }
}

// usamos el HOC `withTheme` para hacer que nuestro componente sea consciente del tema
export default withTheme(QuoteComponent);
```

**Líneas 4-9**: estamos importando el HOC **withTheme**, que utilizaremos más adelante para hacer que nuestro componente sea consciente del tema  
**Líneas 30-41**: una vez que nuestro componente se haya montado en el DOM, intentamos obtener una cita aleatoria de la API y almacenamos el resultado en el estado del componente  
**Líneas 60-66**: renderizamos la cita desde el estado del componente  
**Línea 72**: usamos el HOC **withTheme()** para devolver una versión de nuestro componente que es consciente del tema de **Flex**

A continuación, definimos los componentes estilizados simples (**Quote.Styles.js**). Cuando se rendericen, podrán acceder al objeto **Flex theme** a través de sus props, gracias al HOC **withTheme()**.

```js
/* archivo: src/components/Quote/Quote.Styles.js */

import { default as styled } from 'react-emotion';

// contenedor principal
export const QuoteComponentStyled = styled('div')`
  align-items: center;
  display: flex;
  flex: 0 1 auto;
  flex-basis: auto;
  flex-direction: column;
  justify-content: center;
  vertical-align: baseline;
  padding: 0 5vw;
  max-width: 300px;
`;

// encabezado que contiene el texto 'Cita del Día'
export const Header = styled('div')`
  font-size: 10px;
  font-weight: bold;
  font-style: normal;
  font-stretch: normal;
  line-height: normal;
  text-transform: uppercase;
  letter-spacing: 2px;
  margin: 0px 12px 4px;
`;

// línea acentuada debajo del encabezado
export const HeaderLine = styled('div')`
  border-style: solid;
  border-width: 0px 0px 4px;
  border-color: ${(props) => props.theme.colors.flexBlueColor};
`;

// cuerpo de la cita
export const QuoteBody = styled('div')`
  color: ${(props) => props.theme.colors.base8};
  text-align: center;
  padding-top: 20px;
`;

// autor de la cita
export const QuoteAuthor = styled('div')`
  color: ${(props) => props.theme.colors.base10};
  padding-top: 10px;
  padding-bottom: 50px;
  font-weight: bold;
`;
```

**Línea 3**: estamos importando la biblioteca **react-emotion**, que utilizaremos para el estilo  
**Líneas 34, 39, 45**: estamos configurando el estilo del componente dinámicamente usando los colores del tema de **Flex**

Como último paso, necesitamos agregar este componente al **NoTasksCanvas**. Esto sucede en el archivo principal del plugin (**YourPlugin.js**), donde comenzamos originalmente.

```js
import React from 'react';
import { FlexPlugin } from '@twilio/flex-plugin';
import FeatherTheme from './FeatherCorpTheme';
import QuoteComponent from './components/Quote/Quote';

const PLUGIN_NAME = 'FeathercorpPlugin';

export default class FeathercorpPlugin extends FlexPlugin {
  constructor() {
    super(PLUGIN_NAME);
  }

  async init(flex, manager) {
    // set logo
    flex.MainHeader.defaultProps.logoUrl =
      'https://tangerine-toad-5117.twil.io/assets/feathercorp-logo-white.svg';

    // set color theme
    manager.updateConfig({ colorTheme: FeatherTheme });

    // remove default components
    flex.NoTasksCanvas.Content.remove('first-line');
    flex.NoTasksCanvas.Content.remove('second-line');
    flex.NoTasksCanvas.Content.remove('hint');

    // add our quote component
    flex.NoTasksCanvas.Content.add(<QuoteComponent key="qotd" />, {
      sortOrder: -1
    });
  }
}
```

**Línea 4**: estamos importando el componente recién creado al archivo principal del plugin  
**Línea 27**: estamos agregando el componente al **NoTasksCanvas** de **Flex UI**  
**Línea 28**: define dónde debe colocarse este componente entre los hijos existentes de **NoTasksCanvas**, consulta la documentación para una explicación detallada de la opción **sortOrder**

¡Listo! Ahora, cuando pruebes tu plugin, deberías ver la cita del día mostrada.

![[Pasted image 20250209233829.png]]

¡Felicidades! Ahora has construido tu primer componente **React** que puede estilizarse con el tema de **Flex**. Para probar que realmente se estiliza dinámicamente, puedes intentar cambiar el tema o simplemente eliminar el tema personalizado de tu plugin y observar cómo el componente cambia su tema para coincidir con tu **Flex UI**.

---

How can a custom React component gain access to the **Flex** **theme**?

  
Using _withTheme()_ Higher-Order Component

