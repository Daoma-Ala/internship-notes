### **Lección: Personalización de canales personalizados y limitaciones de las cadenas de plantilla**

En esta lección, exploraremos cómo manejar la personalización de texto en **canales personalizados** en Flex, donde las cadenas de plantilla tradicionales pueden no funcionar como se espera. También veremos dos técnicas para superar estas limitaciones.

---

### **Contexto: Canales personalizados en Flex**

Flex es **omnicanal** por naturaleza, lo que significa que puede manejar tareas de diferentes canales, como llamadas de voz, chats de SMS, WhatsApp, Facebook Messenger, e incluso canales personalizados que tú crees. Por ejemplo, podrías crear un canal personalizado para una aplicación de chat interna o para una plataforma de comunicaciones que aún no tenga integración con Twilio.

Sin embargo, cuando se trata de personalizar la información mostrada en tareas de canales personalizados, las **cadenas de plantilla** pueden no comportarse como esperas.

---

### **Ejemplo: Canal personalizado para dispositivos IoT**

Imaginemos que creamos un nuevo canal personalizado para dispositivos **IoT (Internet de las Cosas)** instalados en los vehículos de nuestra empresa. Estos dispositivos envían alertas cuando los conductores se desvían más de 3 millas de la ruta esperada hacia su destino.

Para personalizar la información mostrada cuando llega una nueva alerta, podrías intentar usar una cadena de plantilla como esta:

```javascript
myIoTChannel.templates.TaskListItem.firstLine = "IoT Alert: {{task.attributes.alert}}";
```

Sin embargo, esta cadena de plantilla **no mostrará la información deseada**. ¿Por qué?

---

### **El problema: Compilación de cadenas de plantilla**

El problema radica en que las plantillas de los canales personalizados (como `myIoTChannel`) **no se compilan** por razones de rendimiento. La compilación es el proceso necesario para expandir las cadenas de plantilla (por ejemplo, reemplazar `{{task.attributes.alert}}` con el valor real). Como resultado, la plantilla no se expande y el texto no se muestra correctamente.

---

### **Solución 1: Usar `manager.strings` para la compilación**

Una forma de solucionar este problema es definir la cadena de plantilla en `manager.strings`, ya que estas plantillas **sí se compilan**. Luego, puedes hacer referencia a esta plantilla en la definición de la plantilla del canal.

```javascript
// Definir la plantilla en manager.strings
manager.strings.alertTitle = "IoT Alert: {{task.attributes.alert}}";

// Referenciar la plantilla en el canal personalizado
myIoTChannel.templates.TaskListItem.firstLine = "alertTitle";
```

Con este enfoque, la cadena de plantilla se compila correctamente y se expande durante el tiempo de ejecución.

---

### **Solución 2: Usar una función para generar el texto**

La segunda opción, y la más recomendada, es definir la plantilla del canal como una **función** que devuelve una cadena. Esta función recibe un objeto `task` como parámetro y lo utiliza para generar el texto final.

```javascript
myIoTChannel.templates.TaskListItem.firstLine = (task) => {
    return "IoT Alert: " + task.attributes.alert;
};
```

Este enfoque es más flexible y genérico, ya que no depende de la compilación de cadenas de plantilla.

---

### **Resumen de las soluciones**

| **Enfoque**                     | **Ventajas**                                                                 | **Desventajas**                              |
|----------------------------------|-----------------------------------------------------------------------------|---------------------------------------------|
| **Usar `manager.strings`**       | Simple y directo.                                                           | Requiere definir una plantilla adicional.   |
| **Usar una función**             | Más flexible y genérico. No depende de la compilación de cadenas de plantilla. | Requiere escribir una función personalizada. |

---

### **Próximos pasos**

Ahora que has aprendido a manejar las limitaciones de las cadenas de plantilla en canales personalizados, estás listo para explorar el **Framework de Acciones** en Flex. En la próxima lección, construiremos un plugin para cambiar el comportamiento predeterminado de cómo se manejan las reservas de tareas.

---

### **Resumen**

En esta lección, hemos:

1. Explorado las limitaciones de las cadenas de plantilla en canales personalizados.
2. Aprendido dos técnicas para superar estas limitaciones:
   - Usar `manager.strings` para la compilación de plantillas.
   - Usar una función para generar texto dinámico.
3. Preparado el terreno para explorar el **Framework de Acciones** en la próxima lección.

¡Sigue adelante y sigue construyendo tu experiencia en Flex! 🚀