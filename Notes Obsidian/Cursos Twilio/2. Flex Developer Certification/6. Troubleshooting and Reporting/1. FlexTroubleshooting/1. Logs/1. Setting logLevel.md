# Controles de logLevel

## Verbosidad de la interfaz de usuario de Flex

Al solucionar problemas con la interfaz de usuario de Flex, un buen punto de partida es revisar los mensajes de la consola de tu navegador. Aquí es donde Flex UI mostrará sus registros por defecto:

**Consola del navegador**
![[Pasted image 20250225105545.png]]
La verbosidad de los registros de Flex UI se controla mediante la propiedad `logLevel` de su **Objeto de Configuración**. Pero antes de hablar sobre el `logLevel` en sí, hablemos brevemente sobre qué es el Objeto de Configuración.

### Objeto de Configuración

El Objeto de Configuración es un objeto JSON que almacena propiedades configurables de la interfaz de usuario de Flex y de algunos de sus componentes predeterminados.

Puede verse algo así:

```json
{
  "theme": {
    "colors": {
      "primary": "#0000ff"
    }
  },
  "features": {
    "feature_flag": true
  },
  "logLevel": "error"
}
```

Como muestra este ejemplo, el Objeto de Configuración se puede utilizar para definir propiedades de temas de la interfaz de usuario, habilitar ciertas funciones y, por último pero no menos importante, controlar el nivel de registro (consulta el esquema completo para obtener más información).

### ¿Dónde puedo modificar este Objeto de Configuración?

Hay 3 lugares, que se leen en el siguiente orden:

1. **API REST de Configuración**: El Objeto de Configuración se almacena en la API REST de Configuración en su propiedad `ui_attributes`. Flex UI lo leerá desde aquí cuando se cargue por primera vez.
2. **Archivo `appConfig.js`**: Para instancias de Flex autoalojadas, el Objeto de Configuración también se puede definir en el archivo `appConfig.js`. Los valores aquí anularán los leídos desde la API REST de Configuración.
3. **Plugin**: Para ambas opciones anteriores, puedes personalizar aún más el Objeto de Configuración utilizando un plugin (usando el método `manager.updateConfig()`).

El siguiente diagrama ilustra el orden en el que los valores de los 3 lugares se sobrescriben entre sí:

![[Pasted image 20250225105854.png]]

La versión final del Objeto de Configuración se puede imprimir en la consola de tu navegador escribiendo el siguiente comando:

```javascript
console.log(manager.configuration);
```

**Ejemplo de salida:**

![[Pasted image 20250225105934.png]]

### logLevel

La propiedad `logLevel` del Objeto de Configuración controla la verbosidad de la interfaz de usuario de Flex. Esto se vuelve bastante importante durante la solución de problemas, ya que aumentar la verbosidad puede ayudarte a comprender qué está haciendo la interfaz de usuario y por qué.

`logLevel` puede tener 6 valores posibles:

- `trace` o `0` - el más detallado
- `debug` o `1`
- `info` o `2`
- `warn` o `3`
- `error` o `4`
- `silent` o `5` - el menos detallado

El valor predeterminado de `logLevel` es `error`. Además, para ayudar en la solución de problemas durante el desarrollo de plugins, la interfaz de usuario de Flex instalada localmente con cada plugin de Flex tiene `logLevel` establecido en `debug` por defecto (esto se configura en `appConfig.js`).

### Actualización del valor de logLevel

Actualizar el archivo `appConfig.js` cuando se autoaloja la interfaz de usuario de Flex es tan simple como editar el archivo y establecer `logLevel` al valor deseado.

Sin embargo, actualizar la API REST de Configuración cuando se utiliza `flex.twilio.com` tiene algunas advertencias, específicamente, la propiedad `ui_attributes` siempre se reemplaza en su totalidad. Por lo tanto, la secuencia de actualización debería ser:

1. Obtener el valor actual de la propiedad `ui_attributes` (JSON).
2. Agregar/modificar el valor de `logLevel` en el objeto JSON según sea necesario.
3. Usar la API REST para actualizar `ui_attributes` con el objeto JSON actualizado.

Por ejemplo, podrías usar el siguiente comando para obtener el valor actual:

```bash
curl -X GET https://flex-api.twilio.com/v1/Configuration -u "ACCOUNT_SID:AUTH_TOKEN"
```

Dado que el Objeto de Configuración almacenado en `ui_attributes` no contiene actualmente ningún `logLevel`, agreguémoslo y enviemos el valor actualizado de vuelta:

```bash
curl -X POST https://flex-api.twilio.com/v1/Configuration -u "ACCOUNT_SID:AUTH_TOKEN" -d '{"ui_attributes": {"logLevel": "debug"}}'
```

En respuesta a la solicitud POST, la API devolverá el nuevo valor y podrás verificar que tu valor de `logLevel` se haya establecido como se esperaba.
