# Instrucciones (Instructions)

Las **Instrucciones** realizan gran parte de la orquestación de llamadas que, de otro modo, tendrías que hacer manualmente.

Una vez que se crea una **Reserva (Reservation)**, el trabajador (Worker) debe tomar una decisión sobre qué hacer con la solicitud entrante. Esta decisión se llama **Instrucción (Instruction)**. Las instrucciones son primitivas de control que le indican a TaskRouter cómo manejar la solicitud de reserva.

Si un trabajador no desea trabajar en una tarea específica por cualquier motivo, puede **rechazar** la reserva. Si desea la tarea, **aceptará** la reserva.

Sin embargo, aceptar una reserva solo asignará la tarea al trabajador a nivel de TaskRouter. Tu aplicación aún necesitará implementar las acciones necesarias para que el agente pueda trabajar en la tarea (por ejemplo, conectar al agente con la persona que llama, en el caso de tareas de voz).

Es por eso que, además de simplemente aceptar o rechazar una reserva, los trabajadores también pueden responder con instrucciones que proporcionan un nivel más profundo de integración con la **API de Voz Programable de Twilio** y realizan gran parte de la orquestación de llamadas que, de otro modo, tendrías que manejar tú mismo.

## Tipos de Instrucciones

- **Conference**: Esta es la forma recomendada para conectar llamadas entre clientes y agentes. Inicia una llamada saliente al agente, monitorea si ha contestado y, si lo ha hecho, se creará automáticamente una conferencia (nombrada por el TaskSid). En ese momento, el agente se unirá a la conferencia y el cliente será eliminado de la cola de espera para ser puesto en la conferencia con el agente.

- **Dequeue**: Esto es similar a la opción de conferencia, pero el cliente y el agente se conectan directamente, sin configurar una conferencia. Generalmente se recomienda usar una conferencia, ya que facilita la adición de otros agentes o la implementación de transferencias de llamada en caliente.

- **Call**: Aquí se inicia una nueva llamada saliente. Esto es útil si no hay una llamada de cliente asociada con la tarea, y en su lugar, la tarea representa algo como una solicitud para devolver una llamada.

- **Redirect**: Aquí, la llamada del cliente se redirige a un documento **TwiML** con instrucciones adicionales sobre cómo se debe manejar la llamada.

## contact_uri

Anteriormente, mencionamos que tanto los atributos de la **Tarea (Task)** como del **Trabajador (Worker)** son completamente arbitrarios y su estructura no sigue ningún esquema. Cualquier estructura JSON que utilices para tus atributos, puedes usarla posteriormente en las expresiones de TaskRouter para controlar la lógica de enrutamiento.

Sin embargo, hay una excepción: el atributo **contact_uri** del trabajador.

Cuando se emite una instrucción que crea una llamada saliente (es decir, `conference`, `dequeue` o `call`), puedes especificar opcionalmente un parámetro `To` con el número de contacto del agente. Si no se especifica ningún parámetro `To`, los detalles de contacto del trabajador se recuperarán de su atributo `contact_uri`, y la llamada saliente se realizará a ese número de teléfono / dirección SIP / ID de cliente.