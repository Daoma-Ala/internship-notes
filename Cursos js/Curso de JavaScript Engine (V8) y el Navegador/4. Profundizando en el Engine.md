
Una vez que se ejecuta un archivo en el navegador, **el motor de JavaScript genera un entorno global** _(Global environment)_. El entorno global hace tres cosas muy importantes:

- Genera un **objeto global** llamado `window`.
- Genera un **contexto** llamado `this`. En un contexto global `this` es igual a `window`.
- **Ambiente de ejecución**.

Después de generar el entorno global, comienza el **contexto de ejecución** _(Execution context)_ **donde corre el código de JavaScript utilizando un _Stack_ de tareas**, apilándolas una por una, en la cuál la última tarea añadida será la primera en ejecutarse.

Una vez que el motor de JavaScript está interactuando con el navegador, realiza los siguientes procesos:

- **Parser**: genera un parseo del documento completo mediante palabras claves.
    
- **AST:** Se crea a partir de los nodos que genera el _parser_. Es una estructura de árbol que representa tu código sintácticamente. Puedes utilizar la página [AST Explorer](https://astexplorer.net/){target="_blank"} para ver cómo funciona.
    
- **Intérprete:** El intérprete recorre el AST y **genera _Bytecode_** (lenguaje que entiende la computadora y no es binario) basado en la información que contiene. Sin embargo, si el intérprete detecta que puede optimizar tu código, no genera _Bytecode_, sino que genera un proceso de optimización que consiste en el _profiler_ y _compiler_.
    
- **Profiler y compiler:** El _profiler_ monitorea y mira el código para optimizarlo. El _compiler_ optimiza ese código y genera _machine code_ (lenguaje binario). En esta etapa, por la intención de optimizar el código, también genera errores como el _Hoisting_.
    

![Engine JavaScript](https://static.platzi.com/media/user_upload/Engine%20V8-7ee73612-fd87-42db-8b1d-2ec0d21d0d97.jpg)

---

- Una vez el motor recibe un archivo JS genera un Global enviroment
- En el Global enviroment se genera un Global object que es igual a window
- También se genera una variable this
- this depende del contexto, en el entorno global this es igual al objeto global
- Ya despues de generado el entorno global, comienza a correr nuestro código en el contexto de ejecucion, a través de un stack de tareas apiladas
- Una vez que el motor comienza a interactuar con el navegador, genera un parseo del documento completo, para encontrar las keywords y las pasa al AST (abstract syntax tree)

[AST Explorer](https://astexplorer.net/)

- Una vez se tiene el AST, el motor lo pasa al interpreter para retornar bytecode puede ser entendido por la máquina
- Si en la interpretación del AST ve mucho código que se repite y que se puede optimizar entra el profiler o monitor, y optimiza el codigo y lo regresa compilado como bytecode para que la máquina lo pueda comprender. Es justo en este paso donde aparece el hoisting, donde el motor en su función de optimizacion reinterpreta el código de una mejor forma y se pueden presentar errores de programacón.
- El hoisting solo sucede con variables y funciones que se mandan a llamar.